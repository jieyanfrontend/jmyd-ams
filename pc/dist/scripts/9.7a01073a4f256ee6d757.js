(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1232:function(e,t,a){},1235:function(module,exports,__webpack_require__){"use strict";(function(module){Object.defineProperty(exports,"__esModule",{value:!0});var _modal=__webpack_require__(548),_modal2=_interopRequireDefault(_modal),_alert=__webpack_require__(1234),_alert2=_interopRequireDefault(_alert),_form=__webpack_require__(542),_form2=_interopRequireDefault(_form),_input=__webpack_require__(549),_input2=_interopRequireDefault(_input),_button=__webpack_require__(533),_button2=_interopRequireDefault(_button),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();__webpack_require__(552),__webpack_require__(1233),__webpack_require__(541),__webpack_require__(537),__webpack_require__(536);var _react=__webpack_require__(1),_react2=_interopRequireDefault(_react),enterModule;function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}enterModule=__webpack_require__(20).enterModule,enterModule&&enterModule(module);var UpdateModal=function(_React$Component){function UpdateModal(){var e,t,a;_classCallCheck(this,UpdateModal);for(var r=arguments.length,_=Array(r),n=0;n<r;n++)_[n]=arguments[n];return t=a=_possibleConstructorReturn(this,(e=UpdateModal.__proto__||Object.getPrototypeOf(UpdateModal)).call.apply(e,[this].concat(_))),a.setValue=function(e){a.props.form.setFields({task_type_name:{value:e.task_type_name},time_warn:{value:e.time_warn},time_out:{value:e.time_out}})},a.hasErrors=function(e){return Object.keys(e).some(function(t){return e[t]})},a.ensure=function(){var e=a.props.form.getFieldsValue(),t=a.props.type;a.props.ensure(_extends({task_type_id:t.task_type_id},e))},_possibleConstructorReturn(a,t)}return _inherits(UpdateModal,_React$Component),_createClass(UpdateModal,[{key:"render",value:function(){var e=this,t=this.props,a=t.visible,r=t.close,_=t.type,n=this.props.form,o=n.getFieldDecorator,u=n.isFieldTouched,l=n.getFieldError,i=n.getFieldsError,c=u("task_type_name")&&l("task_type_name"),s=u("time_warn")&&l("time_warn"),d=u("time_out")&&l("time_out");return _react2.default.createElement(_modal2.default,{footer:_react2.default.createElement("div",null,_react2.default.createElement(_button2.default,{onClick:function(){return r()}},"取消"),_react2.default.createElement(_button2.default,{type:"primary",onClick:function(){return e.ensure()},disabled:this.hasErrors(i(["task_type_name","time_warn","time_out"]))},"确认")),visible:a,title:"你正在编辑 "+_.task_type_name},_react2.default.createElement(_form2.default,null,_react2.default.createElement(_form2.default.Item,{validateStatus:c?"error":"",help:c||"",label:"任务类型"},o("task_type_name",{rules:[{required:!0,message:"请输入任务类型名称"}]})(_react2.default.createElement(_input2.default,{onChange:function(){return e.handleChange()},disabled:!0}))),_react2.default.createElement(_form2.default.Item,{validateStatus:s?"error":"",help:s||"",label:"预警时间"},o("time_warn",{rules:[{required:!0,message:"请输入预警时间"}]})(_react2.default.createElement(_input2.default,{addonAfter:"小时 "}))),_react2.default.createElement(_form2.default.Item,{validateStatus:d?"error":"",help:d||"",label:"超时时间"},o("time_out",{rules:[{required:!0,message:"请输入超时时间"}]})(_react2.default.createElement(_input2.default,{addonAfter:"小时"})))),_react2.default.createElement(_alert2.default,{type:"warning",message:"注意：编辑该任务类型的预警时间及超时时间将会影响相同任务类型的预警时间和超时时间"}))}},{key:"componentWillReceiveProps",value:function(e){e.type.task_type_id!==this.props.type.task_type_id&&this.setValue(e.type)}},{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),UpdateModal}(_react2.default.Component),UpdateModalForm=_form2.default.create()(UpdateModal),_default=UpdateModalForm,reactHotLoader,leaveModule;exports.default=_default,reactHotLoader=__webpack_require__(20).default,leaveModule=__webpack_require__(20).leaveModule,reactHotLoader&&(reactHotLoader.register(UpdateModal,"UpdateModal","E:/frontend/jmyd-ams/pc/src/components/update-modal.js"),reactHotLoader.register(UpdateModalForm,"UpdateModalForm","E:/frontend/jmyd-ams/pc/src/components/update-modal.js"),reactHotLoader.register(_default,"default","E:/frontend/jmyd-ams/pc/src/components/update-modal.js"),leaveModule(module))}).call(this,__webpack_require__(68)(module))},1237:function(e,t,a){e.exports={card:"setting__card",form_item:"setting__form_item",search_form:"setting__search_form",system_btn_group:"setting__system_btn_group"}},522:function(module,exports,__webpack_require__){"use strict";(function(module){Object.defineProperty(exports,"__esModule",{value:!0});var _table=__webpack_require__(563),_table2=_interopRequireDefault(_table),_card=__webpack_require__(912),_card2=_interopRequireDefault(_card),_row=__webpack_require__(1241),_row2=_interopRequireDefault(_row),_button=__webpack_require__(533),_button2=_interopRequireDefault(_button),_col=__webpack_require__(1240),_col2=_interopRequireDefault(_col),_form=__webpack_require__(542),_form2=_interopRequireDefault(_form),_input=__webpack_require__(549),_input2=_interopRequireDefault(_input),_notification2=__webpack_require__(689),_notification3=_interopRequireDefault(_notification2),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();__webpack_require__(562),__webpack_require__(899),__webpack_require__(1239),__webpack_require__(536),__webpack_require__(1238),__webpack_require__(541),__webpack_require__(537),__webpack_require__(687);var _react=__webpack_require__(1),_react2=_interopRequireDefault(_react),_reactRouterDom=__webpack_require__(116),_setting=__webpack_require__(1237),_setting2=_interopRequireDefault(_setting),_request=__webpack_require__(547),_request2=_interopRequireDefault(_request),_updateModal=__webpack_require__(1235),_updateModal2=_interopRequireDefault(_updateModal),enterModule;function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}enterModule=__webpack_require__(20).enterModule,enterModule&&enterModule(module);var Setting=function(_React$Component){function Setting(){var e,t,a;_classCallCheck(this,Setting);for(var r=arguments.length,_=Array(r),n=0;n<r;n++)_[n]=arguments[n];return t=a=_possibleConstructorReturn(this,(e=Setting.__proto__||Object.getPrototypeOf(Setting)).call.apply(e,[this].concat(_))),a.state={taskTypeList:[],loop:"",addTypeErr:!1,updating:!1,updateType:{}},a.columns=[{title:"任务类型",dataIndex:"task_type_name"},{title:"预警时间",dataIndex:"time_warn",render:function(e){return _react2.default.createElement("span",null,"提前",e,"小时")}},{title:"超时时间",dataIndex:"time_out",render:function(e){return _react2.default.createElement("span",null,"提前",e,"小时")}},{title:"操作",dataIndex:"task_type_id",render:function(e,t){return _react2.default.createElement("span",null,_react2.default.createElement("a",{onClick:function(){return a.updateING(t)},style:{marginRight:"8px"}},"修改"),_react2.default.createElement("a",{onClick:function(){return a.deleteType(e)}},"删除"))}}],a.hasErrors=function(e){return Object.keys(e).some(function(t){return e[t]})},a.fetchTaskTypeList=function(){(0,_request2.default)({url:"/api/get_config",data:{},success:function(e){var t=e.table,r=e.loop;a.props.form.setFields({loop:{value:r}}),a.setState({taskTypeList:t||[],loop:r})}})},a.handleAddTaskType=function(e){e.preventDefault();var t=a;a.props.form.validateFields(["task_type_name","time_warn","time_out"],function(e,r){if(!e){var _=r.task_type_name,n=r.time_warn,o=r.time_out;(0,_request2.default)({url:"/api/add_type",data:{task_type_name:_,time_warn:n,time_out:o},success:function(e){_notification3.default.success({message:"新增任务类型成功",description:""}),t.props.form.setFields({task_type_name:"",time_warn:"",time_out:""}),t.props.form.validateFields(),t.fetchTaskTypeList()},fail:function(e){a.setState({addTypeErr:"不可重复新增"})}})}})},a.updateING=function(e){a.setState({updating:!0,updateType:e})},a.closeModal=function(){a.setState({updating:!1})},a.updateType=function(e){var t=e.task_type_id,r=e.time_warn,_=e.time_out;(0,_request2.default)({url:"/api/update_type",data:{task_type_id:t,time_warn:r,time_out:_},success:function(e){_notification3.default.success({message:"修改任务类型成功"}),a.closeModal(),a.fetchTaskTypeList()}})},a.deleteType=function(e){(0,_request2.default)({url:"/api/delete_type",data:{task_type_id:e},success:function(){_notification3.default.success({message:"删除任务类型成功"}),a.fetchTaskTypeList()}})},a.handleSetLoop=function(e){e.preventDefault();var t=a;a.props.form.validateFields(["loop"],function(e,a){e||(0,_request2.default)({url:"/api/set_loop",data:{loop_time:a.loop},success:function(){_notification3.default.success({message:"设置查询周期成功",description:"设置成功后将每隔"+a.loop+"分钟自动刷新一次"}),t.fetchTaskTypeList()}})})},a.handleChange=function(){a.setState({addTypeErr:!1})},_possibleConstructorReturn(a,t)}return _inherits(Setting,_React$Component),_createClass(Setting,[{key:"render",value:function(){var e=this,t=this.props.form,a=t.getFieldDecorator,r=t.isFieldTouched,_=t.getFieldError,n=t.getFieldsError,o=this.state,u=o.taskTypeList,l=o.loop,i=o.addTypeErr,c=o.updating,s=o.updateType,d=r("task_type_name")&&_("task_type_name")||i,p=r("time_warn")&&_("time_warn"),f=r("time_out")&&_("time_out"),m=r("loop")&&_("loop");return _react2.default.createElement("div",null,_react2.default.createElement(_updateModal2.default,{visible:c,type:s,ensure:function(t){return e.updateType(t)},close:function(){return e.closeModal()}}),_react2.default.createElement(_card2.default,{title:"任务设置",className:_setting2.default.card,bordered:!1},_react2.default.createElement(_form2.default,{onSubmit:this.handleAddTaskType,layout:"inline",className:_setting2.default.search_form},_react2.default.createElement(_row2.default,{gutter:24},_react2.default.createElement(_col2.default,{span:7},_react2.default.createElement(_form2.default.Item,{validateStatus:d?"error":"",help:d||"",label:"任务类型",className:_setting2.default.form_item},a("task_type_name",{rules:[{required:!0,message:"请输入任务类型名称"}]})(_react2.default.createElement(_input2.default,{onChange:function(){return e.handleChange()}})))),_react2.default.createElement(_col2.default,{span:7},_react2.default.createElement(_form2.default.Item,{validateStatus:p?"error":"",help:p||"",label:"预警时间",className:_setting2.default.form_item},a("time_warn",{rules:[{required:!0,message:"请输入预警时间"}]})(_react2.default.createElement(_input2.default,{addonAfter:"小时 "})))),_react2.default.createElement(_col2.default,{span:7},_react2.default.createElement(_form2.default.Item,{validateStatus:f?"error":"",help:f||"",label:"超时时间",className:_setting2.default.form_item},a("time_out",{rules:[{required:!0,message:"请输入超时时间"}]})(_react2.default.createElement(_input2.default,{addonAfter:"小时"})))),_react2.default.createElement(_col2.default,null,_react2.default.createElement(_form2.default.Item,null,_react2.default.createElement(_button2.default,{disabled:this.hasErrors(n(["task_type_name","time_warn","time_out"])),type:"primary",icon:"plus",htmlType:"submit"},"新增")))))),_react2.default.createElement(_card2.default,{className:_setting2.default.card,bordered:!1},_react2.default.createElement(_table2.default,{columns:this.columns,dataSource:u,rowKey:"task_type_id",pagination:!1})),_react2.default.createElement(_card2.default,{title:"系统设置",className:_setting2.default.card,bordered:!1},_react2.default.createElement(_form2.default,{name:"form2",onSubmit:this.handleSetLoop,layout:"inline",className:_setting2.default.search_form},_react2.default.createElement(_row2.default,{gutter:24},_react2.default.createElement(_col2.default,{span:8},_react2.default.createElement(_form2.default.Item,{validateStatus:m?"error":"",help:m||"",label:"查询周期",className:_setting2.default.form_item},a("loop",{initialValue:l,rules:[{required:!0,message:"请输入查询周期"},{validator:function(e,t,a){return parseFloat(t)===parseFloat(l)?a("请输入一个新的查询周期"):a()},pattern:/^[1-9]\d*$/}]})(_react2.default.createElement(_input2.default,{autoComplete:"off",addonAfter:"分钟"}))))),_react2.default.createElement(_form2.default.Item,{className:_setting2.default.system_btn_group},_react2.default.createElement(_reactRouterDom.Link,{to:"/"},_react2.default.createElement(_button2.default,{type:"default",style:{marginRight:"16px"}},"返回")),_react2.default.createElement(_button2.default,{disabled:!r("loop")||this.hasErrors(n(["loop"])),type:"primary",htmlType:"submit"},"保存")))))}},{key:"componentDidMount",value:function(){this.props.form.validateFields(),this.fetchTaskTypeList()}},{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),Setting}(_react2.default.Component),SettingForm=_form2.default.create()(Setting),_default=SettingForm,reactHotLoader,leaveModule;exports.default=_default,reactHotLoader=__webpack_require__(20).default,leaveModule=__webpack_require__(20).leaveModule,reactHotLoader&&(reactHotLoader.register(Setting,"Setting","E:/frontend/jmyd-ams/pc/src/pages/setting/setting.js"),reactHotLoader.register(SettingForm,"SettingForm","E:/frontend/jmyd-ams/pc/src/pages/setting/setting.js"),reactHotLoader.register(_default,"default","E:/frontend/jmyd-ams/pc/src/pages/setting/setting.js"),leaveModule(module))}).call(this,__webpack_require__(68)(module))}}]);
//# sourceMappingURL=9.7a01073a4f256ee6d757.js.map